var FileSaver=require("file-saver");function ready(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}require("pathseg"),ready((function(){require("./faq");const e=require("./progress"),t=require("./dxf_metadata");var n=document.getElementById("demo"),o=document.getElementById("upload"),r=document.getElementById("select");n.onclick=function(){try{var e=window.SvgNest.parsesvg(r.innerHTML);r.innerHTML="",r.appendChild(e)}catch(e){return a.innerHTML=e,void(a.className="error animated bounce")}var t,n;t=document.getElementById("splash"),n=document.getElementById("svgnest"),t&&t.remove(),n.setAttribute("style","display: block"),a.innerHTML="Click on the outline to use as the bin",a.className="active animated bounce",function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];1==n.nodeType&&(n.onclick=function(){if("disabled"!=r.className){var e=document.querySelector("#select .active");if(e){var t=e.getAttribute("class").replace("active","").trim();t?e.setAttribute("class",t):e.removeAttribute("class")}window.SvgNest.setbin(this),this.setAttribute("class",(this.getAttribute("class")?this.getAttribute("class")+" ":"")+"active"),s.className="button start animated bounce",a.className=""}})}}(e)};var a=document.getElementById("message");if(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)return a.innerHTML="Your browser does not have SVG support",void(a.className="error animated bounce");if(!window.SvgNest)return a.innerHTML="Couldn't initialize SVGnest",void(a.className="error animated bounce");if(!window.File||!window.FileReader)return a.innerHTML="Your browser does not have file upload support",void(a.className="error animated bounce");if(!window.Worker)return a.innerHTML="Your browser does not have web worker support",void(a.className="error animated bounce");o=document.getElementById("upload");var s=document.getElementById("start"),i=document.getElementById("download"),c=document.getElementById("startlabel"),l=document.getElementById("fileinput"),d=document.getElementById("config"),u=document.getElementById("configbutton"),m=document.getElementById("configsave"),g=document.getElementById("zoominbutton"),v=document.getElementById("zoomoutbutton"),f=document.getElementById("exitbutton"),b=!1;function p(){SvgNest.stop(),c.innerHTML="Start Nest",s.className="button start",u.className="button config",b=!1}s.onclick=function(){if("button start disabled"==this.className)return!1;E=0,b?p():function(){document.removeEventListener("dragover",N,!1),document.removeEventListener("dragleave",N,!1),document.removeEventListener("drop",h,!1),SvgNest.start(e.start(),S),c.innerHTML="Stop Nest",s.className="button spinner",u.className="button config disabled",d.className="",g.className="button zoomin disabled",v.className="button zoomout disabled";var t=document.querySelector("#select svg");t&&t.removeAttribute("style"),b=!0}(),r.className="disabled",document.getElementById("info_time").setAttribute("style","display: none")};var y=!1;function N(e){e.stopPropagation(),e.preventDefault(),o.style.backgroundColor="dragover"==e.type?"#d7e9b7":""}function h(e){e.stopPropagation(),e.preventDefault(),t.getDxfMetadata(e.dataTransfer.files[0])}u.onclick=function(){return"button config disabled"==this.className||(y?(d.className="",u.className="button config"):(d.className="active",u.className="button close"),y=!y),!1},m.onclick=function(){for(var e={},t=document.querySelectorAll("#config input"),n=0;n<t.length;n++){var o=t[n].getAttribute("data-config");"text"==t[n].getAttribute("type")?e[o]=t[n].value:"checkbox"==t[n].getAttribute("type")&&(e[o]=t[n].checked)}return window.SvgNest.config(e),b&&p(),y=!1,d.className="",!1},o.onclick=function(){l.click()},document.addEventListener("dragover",N,!1),document.addEventListener("dragleave",N,!1),document.addEventListener("drop",h,!1),i.onclick=function(){if("button download disabled"==i.className)return!1;var e,t=document.getElementById("bins");if(0==t.children.length)return a.innerHTML="No SVG to export",void(a.className="error animated bounce");(e=r.querySelector("svg"))||(e=document.createElementNS("http://www.w3.org/2000/svg","svg")),e=e.cloneNode(!1),SvgNest.style&&e.appendChild(SvgNest.style);for(var n,o=parseInt(t.children[0].getAttribute("height")),s=0;s<t.children.length;s++){var c=t.children[s],l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("transform","translate(0 "+1.1*o*s+")");for(var d=0;d<c.children.length;d++)l.appendChild(c.children[d].cloneNode(!0));e.appendChild(l)}n="undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(e):e.outerHTML;var u=new Blob([n],{type:"image/svg+xml;charset=utf-8"});FileSaver.saveAs(u,"SVGnest-output.svg")};var w=1;g.onclick=function(){if("button zoomin disabled"==this.className)return!1;w*=1.2;var e=document.querySelector("#select svg");e&&e.setAttribute("style","transform-origin: top left; transform:scale("+w+"); -webkit-transform:scale("+w+"); -moz-transform:scale("+w+"); -ms-transform:scale("+w+"); -o-transform:scale("+w+");")},v.onclick=function(){if("button zoomout disabled"==this.className)return!1;(w*=.8)<.02&&(w=.02);var e=document.querySelector("#select svg");e&&e.setAttribute("style","transform-origin: top left; transform:scale("+w+"); -webkit-transform:scale("+w+"); -moz-transform:scale("+w+"); -ms-transform:scale("+w+"); -o-transform:scale("+w+");")},f.onclick=function(){location.reload()},l.onchange=function(e){t.getDxfMetadata(e.target.files[0])};var E=0;function S(e,t,n,o){if(E++,document.getElementById("info_iterations").innerHTML=E,e&&0!=e.length){var a=document.getElementById("bins");a.innerHTML="";for(var s=0;s<e.length;s++)e.length>2&&e[s].setAttribute("class","grid"),a.appendChild(e[s]);(t||0===t)&&(document.getElementById("info_efficiency").innerHTML=Math.round(100*t)),document.getElementById("info_placed").innerHTML=n+"/"+o,document.getElementById("info_placement").setAttribute("style","display: block"),r.setAttribute("style","display: none"),i.className="button download animated bounce"}}a.onclick=function(e){this.className=""}}));